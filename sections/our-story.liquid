<link rel="stylesheet" href="{{ 'about.css' | asset_url }}">

<style>
  /* Mobile-specific styles for our-story section */
  @media (max-width: 768px) {
    .story-container {
      cursor: default;
      margin: 0 15px;
      margin: 0 1px;
    }
    
    .story-top, .story-bottom {
      cursor: default;
    }
    
    .story-content {
      height: auto !important;
      overflow: visible;
      display: block !important;
    }
    
    .story-text-content {
      padding: 40px 30px !important;
      background-color: transparent;
      border: none;
      margin: 0;
      min-height: auto;
      max-height: none;
    }
    
    /* Mobile background image for story-text-content */
    .story-text-content {
      background-image: url('{{ section.settings.story_content_bg_mobile | img_url: "master" }}');
      background-size: contain;
      background-position: center;
      background-repeat: no-repeat;
    }
    
    .story-text-content p {
      margin: 0 0 20px 0 !important;
      text-align: left;
      line-height: 1.6;
      color: #000000 !important;
      font-weight: 500;
      padding: 0 10px;
    }
    
    .story-text-content p:last-child {
      margin-bottom: 0 !important;
    }
    
    /* Remove hover effects on mobile */
    .story-container:hover .story-content {
      height: auto !important;
    }
    
    /* Mobile image styling */
    .story-bg-image-mobile {
      display: block;
    }
    
    .story-bg-image-desktop {
      display: none;
    }
    
    /* Hide scrollbar on mobile */
    .story-text-content::-webkit-scrollbar {
      display: none;
    }
    
    .story-text-content {
      -ms-overflow-style: none;
      scrollbar-width: none;
    }
  }
  
  /* Desktop styles */
  @media (min-width: 769px) {
    .story-container:hover .story-content {
      height: 380px !important;
    }
    
    .story-bg-image-mobile {
      display: none;
    }
    
    .story-bg-image-desktop {
      display: block;
    }
    
    /* Desktop background image for story-text-content */
    .story-text-content {
      background-image: url('{{ section.settings.story_content_bg | img_url: "master" }}');
      background-size: contain;
      background-position: center;
      background-repeat: no-repeat;
    }
  }
</style>

<section 
  class="our-story-section"
  style="max-width:{{ section.settings.max_width }}px;margin:0 auto;padding-bottom:{{ section.settings.padding_bottom }}px;"
>
  <div class="story-container" style="cursor:pointer;">
    <div class="story-top" style="position:relative;overflow:hidden;">
      {% if section.settings.story_top_img != blank %}
        <img src="{{ section.settings.story_top_img | img_url: 'master' }}" 
             alt="Our Story Top" 
             width="800"
             height="148"
             class="story-bg-image story-bg-image-desktop" 
             style="width:100%;height:148px;object-fit:contain;"
             loading="lazy">
      {% endif %}
      {% if section.settings.story_top_img_mobile != blank %}
        <img src="{{ section.settings.story_top_img_mobile | img_url: 'master' }}" 
             alt="Our Story Top Mobile" 
             width="400"
             height="100"
             class="story-bg-image story-bg-image-mobile" 
             style="width:100%;height:100%;object-fit:contain;"
             loading="lazy">
      {% endif %}
      <div class="story-text" style="z-index:2;font-size:{{ section.settings.heading_size }}px;color:{{ section.settings.heading_color }};">{{ section.settings.heading_top }}</div>
    </div>
    <div class="story-content" style="height:0;overflow:hidden;transition:height 0.7s ease;position:relative;">
      <div class="story-text-content" style="position:relative;z-index:2;padding:40px 20px;min-height:120px;display:flex;flex-direction:column;justify-content:center;text-align:center;">
        {% for block in section.blocks %}
          <p style="margin:0px 40px 20px 40px;color:{{ section.settings.text_color }};">{{ block.settings.paragraph }}</p>
        {% endfor %}
      </div>
    </div>
    <div class="story-bottom" style="position:relative;overflow:hidden;margin-top:-6px;">
      {% if section.settings.story_bottom_img != blank %}
        <img src="{{ section.settings.story_bottom_img | img_url: 'master' }}" 
             alt="Our Story Bottom" 
             width="800"
             height="148"
             class="story-bg-image story-bg-image-desktop" 
             style="width:100%;height:148px;object-fit:contain;"
             loading="lazy">
      {% endif %}
      {% if section.settings.story_bottom_img_mobile != blank %}
        <img src="{{ section.settings.story_bottom_img_mobile | img_url: 'master' }}" 
             alt="Our Story Bottom Mobile" 
             width="400"
             height="100"
             class="story-bg-image story-bg-image-mobile" 
             style="width:100%;height:100%;object-fit:contain;"
             loading="lazy">
      {% endif %}
      <div class="story-text" style="z-index:2;font-size:{{ section.settings.heading_size }}px;color:{{ section.settings.heading_color }};">{{ section.settings.heading_bottom }}</div>
    </div>
  </div>
</section>

<script>
document.addEventListener('DOMContentLoaded', function() {
  var container = document.querySelector('.story-container');
  var content = document.querySelector('.story-content');
  
  if(container && content) {
    // Desktop hover functionality only
    if (window.innerWidth > 768) {
      container.addEventListener('mouseenter', function() {
        content.style.height = '380px';
      });
      container.addEventListener('mouseleave', function() {
        content.style.height = '0';
      });
    }
    
    // Mobile: content stays open by default
    if (window.innerWidth <= 768) {
      content.style.height = 'auto';
      content.style.overflow = 'visible';
    }
  }
  
  // Handle window resize
  window.addEventListener('resize', function() {
    if (window.innerWidth <= 768) {
      // Mobile view - content stays open
      content.style.height = 'auto';
      content.style.overflow = 'visible';
    } else {
      // Desktop view - reset to hover behavior
      content.style.height = '0';
      content.style.overflow = 'hidden';
    }
  });
});
</script>

{% schema %}
{
  "name": "Our Story",
  "settings": [
    {
      "type": "image_picker",
      "id": "story_top_img",
      "label": "Top Image (Desktop)"
    },
    {
      "type": "image_picker",
      "id": "story_top_img_mobile",
      "label": "Top Image (Mobile)"
    },
    {
      "type": "image_picker",
      "id": "story_bottom_img",
      "label": "Bottom Image (Desktop)"
    },
    {
      "type": "image_picker",
      "id": "story_bottom_img_mobile",
      "label": "Bottom Image (Mobile)"
    },
    {
      "type": "image_picker",
      "id": "story_content_bg",
      "label": "Content Background Image (Desktop)"
    },
    {
      "type": "image_picker",
      "id": "story_content_bg_mobile",
      "label": "Content Background Image (Mobile)",
      "info": "This image will be used as the background for the content area on mobile devices"
    },
    {
      "type": "text",
      "id": "heading_top",
      "label": "Top Heading Text",
      "default": "Our"
    },
    {
      "type": "text",
      "id": "heading_bottom",
      "label": "Bottom Heading Text",
      "default": "Story"
    },
    {
      "type": "color",
      "id": "heading_color",
      "label": "Heading Color",
      "default": "#080707"
    },
    {
      "type": "range",
      "id": "heading_size",
      "min": 18,
      "max": 54,
      "step": 2,
      "label": "Heading Font Size (px)",
      "default": 24
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Paragraph Text Color",
      "default": "#080707"
    },
    {
      "type": "range",
      "id": "max_width",
      "min": 600,
      "max": 1400,
      "step": 20,
      "label": "Max Width (px)",
      "default": 900
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 100,
      "step": 10,
      "label": "Bottom Padding (px)",
      "default": 40
    }
  ],
  "blocks": [
    {
      "type": "paragraph",
      "name": "Paragraph",
      "settings": [
        {
          "type": "textarea",
          "id": "paragraph",
          "label": "Paragraph",
          "default": "Retro Fam began as a forumâ€” for retro gaming enthusiasts sharing memories, tips, and repair guide lists. From that passion grew something bigger: a mission to make retro gaming accessible to all and keeping it alive for future generations."
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Our Story",
      "category": "About Sections"
    }
  ]
}
{% endschema %}
